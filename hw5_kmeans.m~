clear;

rng(4);
num_items = 10;
num_dimensions = 2;
data = randi(10,num_items,num_dimensions);

K = 3;

centroids = sortrows(data(1:K,:));
memberships = zeros(size(data,1), 1);


data
centroids

while 1
    total = 0;
    for i=1:size(data,1)
        k = 1;
        min = 2*num_items^2;
        for j=1:K
             dist = (norm(data(i,:)-centroids(j,:)).^2);
             
             if (dist < min)
                min = dist;
                k = j;
             end
        end
        memberships(i)=k;
    end 
    
    new_centroids = centroids;
    for i=1:K
        xi = data(memberships==i,:);
        cj = size(xi,1);

        for j=1:size(data,2)
            new_centroids(i,j) = (1/cj)*sum(xi(:,j));
        end
    end
    
    if (new_centroids == centroids)
        break;
    end
    
    centroids = new_centroids;
end

memberships
new_centroids

% Plot in 2D
if num_dimensions == 2
    x = centroids(:,1);
    y = centroids(:,2);
    
    f = figure();
    axis([0 15 0 15]
    plot(x,y,'+');
    hold on;
    shapes = ['o','*','x','d','s'];
    
    for i=1:K
        idx = (memberships == i);
        
        x = data([idx],1);
        y = data([idx],2);
        
        plot(x,y,shapes(i));
        hold on;
    end
end